import{N as He,O as B,H as te,Y as Ae,as as Ce,c as ce,s as Q,i as $,n as ze,p as F,P as Ve,I as De,g as w,t as Be,u as Ne,S as je,a as ke,e as S,a7 as Xe,at as Le,au as Fe,a5 as X,b as E,T as K,m as Z,aq as Ye,ar as Me,av as qe,L as Ge}from"./BktpiT-y.js";import{_ as I}from"./6vuVcGup.js";const Se=Math.abs,C=Math.atan2,U=Math.cos,Ue=Math.max,Pe=Math.min,W=Math.sin,ee=Math.sqrt,L=1e-12,ae=Math.PI,he=ae/2,Ee=2*ae;function Ke(b){return b>1?0:b<-1?ae:Math.acos(b)}function Oe(b){return b>=1?he:b<=-1?-he:Math.asin(b)}function Ze(b){return b.innerRadius}function $e(b){return b.outerRadius}function Je(b){return b.startAngle}function Qe(b){return b.endAngle}function Ie(b){return b&&b.padAngle}function et(b,t,e,i,s,a,l,r){var c=e-b,u=i-t,n=l-s,p=r-a,o=p*c-n*u;if(!(o*o<L))return o=(n*(t-a)-p*(b-s))/o,[b+o*c,t+o*u]}function ue(b,t,e,i,s,a,l){var r=b-e,c=t-i,u=(l?a:-a)/ee(r*r+c*c),n=u*c,p=-u*r,o=b+n,h=t+p,f=e+n,g=i+p,_=(o+f)/2,y=(h+g)/2,v=f-o,P=g-h,x=v*v+P*P,k=s-a,A=o*g-f*h,O=(P<0?-1:1)*ee(Ue(0,k*k*x-A*A)),j=(A*P-v*O)/x,R=(-A*v-P*O)/x,N=(A*P+v*O)/x,D=(-A*v+P*O)/x,T=j-_,d=R-y,m=N-_,M=D-y;return T*T+d*d>m*m+M*M&&(j=N,R=D),{cx:j,cy:R,x01:-n,y01:-p,x11:j*(s/k-1),y11:R*(s/k-1)}}function tt(){var b=Ze,t=$e,e=B(0),i=null,s=Je,a=Qe,l=Ie,r=null,c=He(u);function u(){var n,p,o=+b.apply(this,arguments),h=+t.apply(this,arguments),f=s.apply(this,arguments)-he,g=a.apply(this,arguments)-he,_=Se(g-f),y=g>f;if(r||(r=n=c()),h<o&&(p=h,h=o,o=p),!(h>L))r.moveTo(0,0);else if(_>Ee-L)r.moveTo(h*U(f),h*W(f)),r.arc(0,0,h,f,g,!y),o>L&&(r.moveTo(o*U(g),o*W(g)),r.arc(0,0,o,g,f,y));else{var v=f,P=g,x=f,k=g,A=_,O=_,j=l.apply(this,arguments)/2,R=j>L&&(i?+i.apply(this,arguments):ee(o*o+h*h)),N=Pe(Se(h-o)/2,+e.apply(this,arguments)),D=N,T=N,d,m;if(R>L){var M=Oe(R/o*W(j)),V=Oe(R/h*W(j));(A-=M*2)>L?(M*=y?1:-1,x+=M,k-=M):(A=0,x=k=(f+g)/2),(O-=V*2)>L?(V*=y?1:-1,v+=V,P-=V):(O=0,v=P=(f+g)/2)}var G=h*U(v),H=h*W(v),J=o*U(k),le=o*W(k);if(N>L){var ne=h*U(P),oe=h*W(P),ye=o*U(x),me=o*W(x),z;if(_<ae)if(z=et(G,H,ye,me,ne,oe,J,le)){var _e=G-z[0],xe=H-z[1],ve=ne-z[0],we=oe-z[1],Te=1/W(Ke((_e*ve+xe*we)/(ee(_e*_e+xe*xe)*ee(ve*ve+we*we)))/2),Re=ee(z[0]*z[0]+z[1]*z[1]);D=Pe(N,(o-Re)/(Te-1)),T=Pe(N,(h-Re)/(Te+1))}else D=T=0}O>L?T>L?(d=ue(ye,me,G,H,h,T,y),m=ue(ne,oe,J,le,h,T,y),r.moveTo(d.cx+d.x01,d.cy+d.y01),T<N?r.arc(d.cx,d.cy,T,C(d.y01,d.x01),C(m.y01,m.x01),!y):(r.arc(d.cx,d.cy,T,C(d.y01,d.x01),C(d.y11,d.x11),!y),r.arc(0,0,h,C(d.cy+d.y11,d.cx+d.x11),C(m.cy+m.y11,m.cx+m.x11),!y),r.arc(m.cx,m.cy,T,C(m.y11,m.x11),C(m.y01,m.x01),!y))):(r.moveTo(G,H),r.arc(0,0,h,v,P,!y)):r.moveTo(G,H),!(o>L)||!(A>L)?r.lineTo(J,le):D>L?(d=ue(J,le,ne,oe,o,-D,y),m=ue(G,H,ye,me,o,-D,y),r.lineTo(d.cx+d.x01,d.cy+d.y01),D<N?r.arc(d.cx,d.cy,D,C(d.y01,d.x01),C(m.y01,m.x01),!y):(r.arc(d.cx,d.cy,D,C(d.y01,d.x01),C(d.y11,d.x11),!y),r.arc(0,0,o,C(d.cy+d.y11,d.cx+d.x11),C(m.cy+m.y11,m.cx+m.x11),y),r.arc(m.cx,m.cy,D,C(m.y11,m.x11),C(m.y01,m.x01),!y))):r.arc(0,0,o,k,x,y)}if(r.closePath(),n)return r=null,n+""||null}return u.centroid=function(){var n=(+b.apply(this,arguments)+ +t.apply(this,arguments))/2,p=(+s.apply(this,arguments)+ +a.apply(this,arguments))/2-ae/2;return[U(p)*n,W(p)*n]},u.innerRadius=function(n){return arguments.length?(b=typeof n=="function"?n:B(+n),u):b},u.outerRadius=function(n){return arguments.length?(t=typeof n=="function"?n:B(+n),u):t},u.cornerRadius=function(n){return arguments.length?(e=typeof n=="function"?n:B(+n),u):e},u.padRadius=function(n){return arguments.length?(i=n==null?null:typeof n=="function"?n:B(+n),u):i},u.startAngle=function(n){return arguments.length?(s=typeof n=="function"?n:B(+n),u):s},u.endAngle=function(n){return arguments.length?(a=typeof n=="function"?n:B(+n),u):a},u.padAngle=function(n){return arguments.length?(l=typeof n=="function"?n:B(+n),u):l},u.context=function(n){return arguments.length?(r=n??null,u):r},u}class ge extends te{constructor(){super(...arguments),Object.defineProperty(this,"ix",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"iy",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_generator",{enumerable:!0,configurable:!0,writable:!0,value:tt()})}_getTooltipPoint(){let t=this.get("tooltipX"),e=this.get("tooltipY"),i=0,s=0;$(t)&&(i=t),$(e)&&(s=e);let a=this.get("radius",0),l=this.get("innerRadius",0),r=this.get("dRadius",0),c=this.get("dInnerRadius",0);return a+=r,l+=c,l<0&&(l=a+l),t instanceof Ae&&(i=this.ix*(l+(a-l)*t.value)),e instanceof Ae&&(s=this.iy*(l+(a-l)*e.value)),this.get("arc")>=360&&l==0&&(i=0,s=0),{x:i,y:s}}_beforeChanged(){super._beforeChanged(),(this.isDirty("radius")||this.isDirty("arc")||this.isDirty("innerRadius")||this.isDirty("startAngle")||this.isDirty("dRadius")||this.isDirty("dInnerRadius")||this.isDirty("cornerRadius")||this.isDirty("shiftRadius"))&&(this._clear=!0)}_changed(){if(super._changed(),this._clear){let t=this.get("startAngle",0),e=this.get("arc",0);const i=this._generator;e<0&&(t=t+e,e=e*-1),e>.1&&i.cornerRadius(this.get("cornerRadius",0)),i.context(this._display);let s=this.get("radius",0),a=this.get("innerRadius",0),l=this.get("dRadius",0),r=this.get("dInnerRadius",0);s+=l,a+=r,a<0&&(a=s+a),i({innerRadius:a,outerRadius:s,startAngle:(t+90)*Ce,endAngle:(t+e+90)*Ce});let c=t+e/2;this.ix=ce(c),this.iy=Q(c);const u=this.get("shiftRadius",0);this.setRaw("dx",this.ix*u),this.setRaw("dy",this.iy*u),this.markDirtyPosition()}}}Object.defineProperty(ge,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Slice"});Object.defineProperty(ge,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:te.classNames.concat([ge.className])});class We extends ze{setupDefaultRules(){super.setupDefaultRules();const t=this._root.interfaceColors,e=this.rule.bind(this);e("PercentSeries").setAll({legendLabelText:"{category}",legendValueText:"{valuePercentTotal.formatNumber('0.00p')}",colors:Ve.new(this._root,{}),width:F,height:F}),e("PieChart").setAll({radius:De(80),startAngle:-90,endAngle:270}),e("PieSeries").setAll({alignLabels:!0,startAngle:-90,endAngle:270}),e("PieSeries").states.create("hidden",{endAngle:-90,opacity:0}),e("Slice",["pie"]).setAll({position:"absolute",isMeasured:!1,x:0,y:0,toggleKey:"active",tooltipText:"{category}: {valuePercentTotal.formatNumber('0.00p')}",strokeWidth:1,strokeOpacity:1,role:"figure",lineJoin:"round"}),e("Slice",["pie"]).states.create("active",{shiftRadius:20,scale:1}),e("Slice",["pie"]).states.create("hoverActive",{scale:1.04}),e("Slice",["pie"]).states.create("hover",{scale:1.04}),e("RadialLabel",["pie"]).setAll({textType:"aligned",radius:10,text:"{category}: {valuePercentTotal.formatNumber('0.00p')}",paddingTop:5,paddingBottom:5,populateText:!0}),e("Tick",["pie"]).setAll({location:1}),e("SlicedChart").setAll({paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10}),e("FunnelSeries").setAll({startLocation:0,endLocation:1,orientation:"vertical",alignLabels:!0,sequencedInterpolation:!0}),e("FunnelSlice").setAll({interactive:!0,expandDistance:0}),e("FunnelSlice").states.create("hover",{expandDistance:.15}),e("Label",["funnel"]).setAll({populateText:!0,text:"{category}: {valuePercentTotal.formatNumber('0.00p')}",centerY:w}),e("Label",["funnel","horizontal"]).setAll({centerX:0,centerY:w,rotation:-90}),e("Label",["funnel","vertical"]).setAll({centerY:w,centerX:0}),e("Tick",["funnel"]).setAll({location:1}),e("FunnelSlice",["funnel","link"]).setAll({fillOpacity:.5,strokeOpacity:0,expandDistance:-.1}),e("FunnelSlice",["funnel","link","vertical"]).setAll({height:10}),e("FunnelSlice",["funnel","link","horizontal"]).setAll({width:10}),e("PyramidSeries").setAll({valueIs:"area"}),e("FunnelSlice",["pyramid","link"]).setAll({fillOpacity:.5}),e("FunnelSlice",["pyramid","link","vertical"]).setAll({height:0}),e("FunnelSlice",["pyramid","link","horizontal"]).setAll({width:0}),e("FunnelSlice",["pyramid"]).setAll({interactive:!0,expandDistance:0}),e("FunnelSlice",["pyramid"]).states.create("hover",{expandDistance:.15}),e("Label",["pyramid"]).setAll({populateText:!0,text:"{category}: {valuePercentTotal.formatNumber('0.00p')}",centerY:w}),e("Label",["pyramid","horizontal"]).setAll({centerX:0,centerY:w,rotation:-90}),e("Label",["pyramid","vertical"]).setAll({centerY:w,centerX:0}),e("Tick",["pyramid"]).setAll({location:1}),e("FunnelSlice",["pictorial"]).setAll({interactive:!0,tooltipText:"{category}: {valuePercentTotal.formatNumber('0.00p')}"}),e("Label",["pictorial"]).setAll({populateText:!0,text:"{category}: {valuePercentTotal.formatNumber('0.00p')}",centerY:w}),e("Label",["pictorial","horizontal"]).setAll({centerX:0,centerY:w,rotation:-90}),e("Label",["pictorial","vertical"]).setAll({centerY:w,centerX:0}),e("FunnelSlice",["pictorial","link"]).setAll({fillOpacity:.5,width:0,height:0}),e("Tick",["pictorial"]).setAll({location:.5});{const i=e("Graphics",["pictorial","background"]);i.setAll({fillOpacity:.2}),Be(i,"fill",t,"alternativeBackground")}}}class Y extends Ne{_afterNew(){this._defaultThemes.push(We.new(this._root)),super._afterNew(),this.chartContainer.children.push(this.seriesContainer),this.seriesContainer.children.push(this.bulletsContainer)}_processSeries(t){super._processSeries(t),this.seriesContainer.children.moveValue(this.bulletsContainer,this.seriesContainer.children.length-1)}}Object.defineProperty(Y,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PercentChart"});Object.defineProperty(Y,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Ne.classNames.concat([Y.className])});class q extends je{constructor(){super(...arguments),Object.defineProperty(this,"slicesContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(ke.new(this._root,{position:"absolute",isMeasured:!1}))}),Object.defineProperty(this,"labelsContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(ke.new(this._root,{position:"absolute",isMeasured:!1}))}),Object.defineProperty(this,"ticksContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(ke.new(this._root,{position:"absolute",isMeasured:!1}))}),Object.defineProperty(this,"_lLabels",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_rLabels",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_hLabels",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"slices",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(this._makeSlices())}),Object.defineProperty(this,"labels",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(this._makeLabels())}),Object.defineProperty(this,"ticks",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(this._makeTicks())})}makeSlice(t){const e=this.slicesContainer.children.push(this.slices.make());return e.on("fill",()=>{this.updateLegendMarker(t)}),e.on("fillPattern",()=>{this.updateLegendMarker(t)}),e.on("stroke",()=>{this.updateLegendMarker(t)}),e._setDataItem(t),t.set("slice",e),this.slices.push(e),e}makeLabel(t){const e=this.labelsContainer.children.push(this.labels.make());return e._setDataItem(t),t.set("label",e),this.labels.push(e),e}_shouldMakeBullet(t){return t.get("value")!=null}makeTick(t){const e=this.ticksContainer.children.push(this.ticks.make());return e._setDataItem(t),t.set("tick",e),this.ticks.push(e),e}_afterNew(){this.fields.push("category","fill"),super._afterNew()}_onDataClear(){const t=this.get("colors");t&&t.reset();const e=this.get("patterns");e&&e.reset()}_prepareChildren(){if(super._prepareChildren(),this._lLabels=[],this._rLabels=[],this._hLabels=[],this._valuesDirty){let t=0,e=0,i=0,s=1/0,a=0;S(this._dataItems,l=>{let r=l.get("valueWorking",0);t+=r,e+=Math.abs(r)}),S(this._dataItems,l=>{let r=l.get("valueWorking",0);r>i&&(i=r),r<s&&(s=r),a++;let c=r/e;e==0&&(c=0),l.setRaw("valuePercentTotal",c*100)}),this.setPrivateRaw("valueLow",s),this.setPrivateRaw("valueHigh",i),this.setPrivateRaw("valueSum",t),this.setPrivateRaw("valueAverage",t/a),this.setPrivateRaw("valueAbsoluteSum",e)}}show(t){const e=Object.create(null,{show:{get:()=>super.show}});return I(this,void 0,void 0,function*(){let i=[];i.push(e.show.call(this,t)),i.push(this._sequencedShowHide(!0,t)),yield Promise.all(i)})}hide(t){const e=Object.create(null,{hide:{get:()=>super.hide}});return I(this,void 0,void 0,function*(){let i=[];i.push(e.hide.call(this,t)),i.push(this._sequencedShowHide(!1,t)),yield Promise.all(i)})}_updateChildren(){super._updateChildren(),this._valuesDirty&&S(this._dataItems,t=>{t.get("label").text.markDirtyText()}),(this.isDirty("legendLabelText")||this.isDirty("legendValueText"))&&S(this._dataItems,t=>{this.updateLegendValue(t)}),this._arrange()}_arrange(){this._arrangeDown(this._lLabels),this._arrangeUp(this._lLabels),this._arrangeDown(this._rLabels),this._arrangeUp(this._rLabels),this._arrangeLeft(this._hLabels),this._arrangeRight(this._hLabels),S(this.dataItems,t=>{this._updateTick(t)})}_afterChanged(){super._afterChanged(),this._arrange()}processDataItem(t){if(super.processDataItem(t),t.get("fill")==null){let e=this.get("colors");e&&t.setRaw("fill",e.next())}if(t.get("fillPattern")==null){let e=this.get("patterns");e&&t.setRaw("fillPattern",e.next())}}showDataItem(t,e){const i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return I(this,void 0,void 0,function*(){const s=[i.showDataItem.call(this,t,e)];$(e)||(e=this.get("stateAnimationDuration",0));const a=this.get("stateAnimationEasing");let l=t.get("value");const r=t.animate({key:"valueWorking",to:l,duration:e,easing:a});r&&s.push(r.waitForStop());const c=t.get("tick");c&&s.push(c.show(e));const u=t.get("label");u&&s.push(u.show(e));const n=t.get("slice");n&&s.push(n.show(e)),n.get("active")&&n.states.applyAnimate("active"),yield Promise.all(s)})}hideDataItem(t,e){const i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return I(this,void 0,void 0,function*(){const s=[i.hideDataItem.call(this,t,e)],a=this.states.create("hidden",{});$(e)||(e=a.get("stateAnimationDuration",this.get("stateAnimationDuration",0)));const l=a.get("stateAnimationEasing",this.get("stateAnimationEasing")),r=t.animate({key:"valueWorking",to:0,duration:e,easing:l});r&&s.push(r.waitForStop());const c=t.get("tick");c&&s.push(c.hide(e));const u=t.get("label");u&&s.push(u.hide(e));const n=t.get("slice");n.hideTooltip(),n&&s.push(n.hide(e)),yield Promise.all(s)})}disposeDataItem(t){super.disposeDataItem(t);let e=t.get("label");e&&(this.labels.removeValue(e),e.dispose());let i=t.get("tick");i&&(this.ticks.removeValue(i),i.dispose());let s=t.get("slice");s&&(this.slices.removeValue(s),s.dispose())}hoverDataItem(t){const e=t.get("slice");e&&!e.isHidden()&&e.hover()}unhoverDataItem(t){const e=t.get("slice");e&&e.unhover()}updateLegendMarker(t){if(t){const e=t.get("slice");if(e){const i=t.get("legendDataItem");if(i){const s=i.get("markerRectangle");S(Xe,a=>{e.get(a)!=null&&s.set(a,e.get(a))})}}}}_arrangeDown(t){if(t){let e=this._getNextDown();t.sort((i,s)=>i.y>s.y?1:i.y<s.y?-1:0),S(t,i=>{const s=i.label.adjustedLocalBounds();let a=s.top;i.y+a<e&&(i.y=e-a),i.label.set("y",i.y),e=i.y+s.bottom})}}_getNextUp(){return this.labelsContainer.maxHeight()}_getNextDown(){return 0}_arrangeUp(t){if(t){let e=this._getNextUp();t.sort((i,s)=>i.y<s.y?1:i.y>s.y?-1:0),S(t,i=>{const s=i.label.adjustedLocalBounds();let a=s.bottom;i.y+a>e&&(i.y=e-a),i.label.set("y",i.y),e=i.y+s.top})}}_arrangeRight(t){if(t){let e=0;t.sort((i,s)=>i.y>s.y?1:i.y<s.y?-1:0),S(t,i=>{const s=i.label.adjustedLocalBounds();let a=s.left;i.y+a<e&&(i.y=e-a),i.label.set("x",i.y),e=i.y+s.right})}}_arrangeLeft(t){if(t){let e=this.labelsContainer.maxWidth();t.sort((i,s)=>i.y<s.y?1:i.y>s.y?-1:0),S(t,i=>{const s=i.label.adjustedLocalBounds();let a=s.right;i.y+a>e&&(i.y=e-a),i.label.set("x",i.y),e=i.y+s.left})}}_updateSize(){super._updateSize(),this.markDirty()}_updateTick(t){}_dispose(){super._dispose();const t=this.chart;t&&t.series.removeValue(this)}}Object.defineProperty(q,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PercentSeries"});Object.defineProperty(q,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:je.classNames.concat([q.className])});class de extends Y{constructor(){super(...arguments),Object.defineProperty(this,"_maxRadius",{enumerable:!0,configurable:!0,writable:!0,value:1})}_afterNew(){super._afterNew(),this.seriesContainer.setAll({x:w,y:w})}_prepareChildren(){super._prepareChildren();const t=this.chartContainer,e=t.innerWidth(),i=t.innerHeight(),s=this.get("startAngle",0),a=this.get("endAngle",0),l=this.get("innerRadius");let r=Le(0,0,s,a,1);const c=e/(r.right-r.left),u=i/(r.bottom-r.top);let n={left:0,right:0,top:0,bottom:0};if(l instanceof Ae){let h=l.value,f=Math.min(c,u);h=Math.max(f*h,f-Math.min(i,e))/f,n=Le(0,0,s,a,h),this.setPrivateRaw("irModifyer",h/l.value)}r=Fe([r,n]);const p=this._maxRadius;this._maxRadius=Math.min(c,u);const o=X(this.get("radius",0),this._maxRadius);this.seriesContainer.setAll({dy:-o*(r.bottom+r.top)/2,dx:-o*(r.right+r.left)/2}),(this.isDirty("startAngle")||this.isDirty("endAngle")||p!=this._maxRadius)&&this.series.each(h=>{h._markDirtyKey("startAngle")}),(this.isDirty("innerRadius")||this.isDirty("radius"))&&this.series.each(h=>{h._markDirtyKey("innerRadius")})}radius(t){let e=X(this.get("radius",0),this._maxRadius),i=X(this.get("innerRadius",0),e);if(t){let s=this.series.indexOf(t),a=this.series.length,l=t.get("radius");return l!=null?i+X(l,e-i):i+(e-i)/a*(s+1)}return e}innerRadius(t){const e=this.radius();let i=X(this.get("innerRadius",0),e);if(i<0&&(i=e+i),t){let s=this.series.indexOf(t),a=this.series.length,l=t.get("innerRadius");return l!=null?i+X(l,e-i):i+(e-i)/a*s}return i}_updateSize(){super._updateSize(),this.markDirtyKey("radius")}}Object.defineProperty(de,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PieChart"});Object.defineProperty(de,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Y.classNames.concat([de.className])});class pe extends q{_makeSlices(){return new E(K.new({}),()=>ge._new(this._root,{themeTags:Z(this.slices.template.get("themeTags",[]),["pie","series"])},[this.slices.template]))}_makeLabels(){return new E(K.new({}),()=>Ye._new(this._root,{themeTags:Z(this.labels.template.get("themeTags",[]),["pie","series"])},[this.labels.template]))}_makeTicks(){return new E(K.new({}),()=>Me._new(this._root,{themeTags:Z(this.ticks.template.get("themeTags",[]),["pie","series"])},[this.ticks.template]))}processDataItem(t){super.processDataItem(t);const e=this.makeSlice(t);e.on("scale",()=>{this._updateTick(t)}),e.on("shiftRadius",()=>{this._updateTick(t)}),e.events.on("positionchanged",()=>{this._updateTick(t)});const i=this.makeLabel(t);i.events.on("positionchanged",()=>{this._updateTick(t)}),this.makeTick(t),e.events.on("positionchanged",()=>{i.markDirty()})}_getNextUp(){const t=this.chart;return t?t._maxRadius:this.labelsContainer.maxHeight()/2}_getNextDown(){const t=this.chart;return t?-t._maxRadius:-this.labelsContainer.maxHeight()/2}_prepareChildren(){super._prepareChildren();const t=this.chart;if(t){if(this.isDirty("alignLabels")){let e=this.labels.template;if(this.get("alignLabels"))e.set("textType","aligned");else{let i=e.get("textType");(i==null||i=="aligned")&&e.set("textType","adjusted")}}if(this._valuesDirty||this.isDirty("radius")||this.isDirty("innerRadius")||this.isDirty("startAngle")||this.isDirty("endAngle")||this.isDirty("alignLabels")){this.markDirtyBounds();const e=this.get("startAngle",t.get("startAngle",-90)),s=this.get("endAngle",t.get("endAngle",270))-e;let a=e;const l=t.radius(this);this.setPrivateRaw("radius",l);let r=t.innerRadius(this)*t.getPrivate("irModifyer",1);r<0&&(r=l+r),S(this._dataItems,c=>{this.updateLegendValue(c);let u=s*c.get("valuePercentTotal")/100;const n=c.get("slice");if(n){n.set("radius",l),n.set("innerRadius",r),n.set("startAngle",a),n.set("arc",u);const h=c.get("fill");n._setDefault("fill",h),n._setDefault("stroke",h);const f=c.get("fillPattern");n._setDefault("fillPattern",f)}let p=qe(a+u/2);const o=c.get("label");if(o&&(o.setPrivate("radius",l),o.setPrivate("innerRadius",r),o.set("labelAngle",p),o.get("textType")=="aligned")){let h=l+o.get("radius",0),f=l*Q(p);p>90&&p<=270?(!o.isHidden()&&!o.isHiding()&&this._lLabels.push({label:o,y:f}),h*=-1,h-=this.labelsContainer.get("paddingLeft",0),o.set("centerX",F),o.setPrivateRaw("left",!0)):(!o.isHidden()&&!o.isHiding()&&this._rLabels.push({label:o,y:f}),h+=this.labelsContainer.get("paddingRight",0),o.set("centerX",0),o.setPrivateRaw("left",!1)),o.set("x",h),o.set("y",l*Q(p))}a+=u,this._updateTick(c)})}}}_updateTick(t){const e=t.get("tick"),i=t.get("label"),s=t.get("slice"),a=e.get("location",1);if(e&&i&&s){const l=(s.get("shiftRadius",0)+s.get("radius",0))*s.get("scale",1)*a,r=i.get("labelAngle",0),c=ce(r),u=Q(r),n=this.labelsContainer,p=n.get("paddingLeft",0),o=n.get("paddingRight",0);let h=0,f=0;h=i.x(),f=i.y();let g=[];if(h!=0||f!=0){if(i.get("textType")=="circular"){const y=i.radius()-i.get("paddingBottom",0),v=i.get("labelAngle",0);h=y*ce(v),f=y*Q(v)}let _=-o;i.getPrivate("left")&&(_=p),g=[{x:s.x()+l*c,y:s.y()+l*u},{x:h+_,y:f},{x:h,y:f}]}e.set("points",g)}}_positionBullet(t){const e=t.get("sprite");if(e){const s=e.dataItem.get("slice");if(s){const a=s.get("innerRadius",0),l=s.get("radius",0),r=s.get("startAngle",0),c=s.get("arc",0),u=t.get("locationX",.5),n=t.get("locationY",.5),p=r+c*u,o=a+(l-a)*n;e.setAll({x:ce(p)*o,y:Q(p)*o})}}}}Object.defineProperty(pe,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PieSeries"});Object.defineProperty(pe,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:q.classNames.concat([pe.className])});class ie extends te{constructor(){super(...arguments),Object.defineProperty(this,"_projectionDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_tlx",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_tly",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_trx",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_try",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_blx",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_bly",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_brx",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_bry",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_cprx",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_cplx",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_cpry",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_cply",{enumerable:!0,configurable:!0,writable:!0,value:0})}_afterNew(){super._afterNew(),this.set("draw",t=>{t.moveTo(this._tlx,this._tly),t.lineTo(this._trx,this._try),t.quadraticCurveTo(this._cprx,this._cpry,this._brx,this._bry),t.lineTo(this._blx,this._bly),t.quadraticCurveTo(this._cplx,this._cply,this._tlx,this._tly)})}getPoint(t,e){let i=this.width(),s=this.height();const a=this.get("topWidth",0),l=this.get("bottomWidth",0);if(this.get("orientation")=="vertical"){let r=-a/2,c=a/2,u=l/2,n=-l/2,p=r+(n-r)*e,o=c+(u-c)*e;return{x:p+(o-p)*t,y:s*e}}else{let r=-a/2,c=a/2,u=l/2,n=-l/2,p=r+(n-r)*t,o=c+(u-c)*t;return{x:i*t,y:p+(o-p)*e}}}_changed(){if(this.isDirty("topWidth")||this.isDirty("bottomWidth")||this.isDirty("expandDistance")||this.isDirty("orientation")||this.isDirty("width")||this.isDirty("height")){const t=this.width(),e=this.height(),i=this.get("topWidth",0),s=this.get("bottomWidth",0);this._clear=!0;let a=this.get("expandDistance",0);this.get("orientation")=="vertical"?(this._tlx=-i/2,this._tly=0,this._trx=i/2,this._try=0,this._brx=s/2,this._bry=e,this._blx=-s/2,this._bly=e,this._cprx=this._trx+(this._brx-this._trx)/2+a*e,this._cpry=this._try+.5*e,this._cplx=this._tlx+(this._blx-this._tlx)/2-a*e,this._cply=this._tly+.5*e):(this._tly=-i/2,this._tlx=0,this._try=i/2,this._trx=0,this._bry=s/2,this._brx=t,this._bly=-s/2,this._blx=t,this._cpry=this._try+(this._bry-this._try)/2+a*t,this._cprx=this._trx+.5*t,this._cply=this._tly+(this._bly-this._tly)/2-a*t,this._cplx=this._tlx+.5*t)}super._changed()}}Object.defineProperty(ie,"className",{enumerable:!0,configurable:!0,writable:!0,value:"FunnelSlice"});Object.defineProperty(ie,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:te.classNames.concat([ie.className])});class se extends q{constructor(){super(...arguments),Object.defineProperty(this,"_tag",{enumerable:!0,configurable:!0,writable:!0,value:"funnel"}),Object.defineProperty(this,"links",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(this._makeLinks())}),Object.defineProperty(this,"_total",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_count",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_nextCoord",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_opposite",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_makeSlices(){return new E(K.new({}),()=>ie._new(this._root,{themeTags:Z(this.slices.template.get("themeTags",[]),[this._tag,"series","slice",this.get("orientation")])},[this.slices.template]))}_makeLabels(){return new E(K.new({}),()=>Ge._new(this._root,{themeTags:Z(this.labels.template.get("themeTags",[]),[this._tag,"series","label",this.get("orientation")])},[this.labels.template]))}_makeTicks(){return new E(K.new({}),()=>Me._new(this._root,{themeTags:Z(this.ticks.template.get("themeTags",[]),[this._tag,"series","tick",this.get("orientation")])},[this.ticks.template]))}_makeLinks(){return new E(K.new({}),()=>ie._new(this._root,{themeTags:Z(this.links.template.get("themeTags",[]),[this._tag,"series","link",this.get("orientation")])},[this.links.template]))}makeLink(t){const e=this.slicesContainer.children.push(this.links.make());return e._setDataItem(t),t.set("link",e),this.links.push(e),e}_afterNew(){super._afterNew();const t=this.slicesContainer;t.setAll({isMeasured:!0,position:"relative",width:De(100),height:De(100)}),t.onPrivate("width",()=>{this.markDirtySize()}),t.onPrivate("height",()=>{this.markDirtySize()}),this.get("orientation")=="vertical"?this.set("layout",this._root.horizontalLayout):this.set("layout",this._root.verticalLayout)}processDataItem(t){super.processDataItem(t);const e=this.makeSlice(t);e._setDataItem(t),t.set("slice",e),this.makeLink(t);const i=this.makeLabel(t);i.on("x",()=>{this._updateTick(t)}),i.on("y",()=>{this._updateTick(t)}),this.makeTick(t),e.events.on("positionchanged",()=>{i.markDirty()}),e.events.on("boundschanged",()=>{const s=e.dataItem;s&&this._updateTick(s)})}_updateChildren(){this._opposite=!1,this.children.indexOf(this.labelsContainer)==0&&(this._opposite=!0);let t=0,e=0;if(S(this.dataItems,i=>{const s=i.get("value");$(s)&&(e++,s>0?t+=Math.abs(i.get("valueWorking",s)/s):this.get("ignoreZeroValues",!1)||i.isHidden()?e--:t+=1)}),this._total=1/e*t,this._count=e,this.isDirty("alignLabels")&&this._fixLayout(),this._total>0&&(this._valuesDirty||this._sizeDirty)){const i=this.slicesContainer;let s;this.get("orientation")=="vertical"?s=i.innerHeight():s=i.innerWidth(),this._nextCoord=this.get("startLocation",0)*s,this.markDirtyBounds();let a=0;S(this._dataItems,l=>{this.updateLegendValue(l),l.set("index",a),a++;const r=l.get("slice"),c=l.get("tick"),u=l.get("label"),n=l.get("link"),p=l.get("fill"),o=l.get("fillPattern");r._setDefault("fill",p),r._setDefault("stroke",p),r._setDefault("fillPattern",o),n._setDefault("fill",p),n._setDefault("stroke",p);const h=l.get("value");$(h)&&(h==0&&this.get("ignoreZeroValues")?(r.setPrivate("visible",!1),c.setPrivate("visible",!1),u.setPrivate("visible",!1)):(r.setPrivate("visible",!0),c.setPrivate("visible",!0),u.setPrivate("visible",!0),this.decorateSlice(l),this.isLast(l)?n.setPrivate("visible",!1):l.isHidden()||n.setPrivate("visible",!0)))})}super._updateChildren()}_fixLayout(){const t=this.get("orientation"),e=this.labelsContainer,i=this.labels.template;this.get("alignLabels")?(e.set("position","relative"),e.setAll({isMeasured:!0}),t=="vertical"?(this.set("layout",this._root.horizontalLayout),i.setAll({centerX:F,x:F})):(this.set("layout",this._root.verticalLayout),i.setAll({centerX:0,x:0}))):(e.setAll({isMeasured:!1,position:"absolute"}),t=="vertical"?(e.setAll({x:w}),i.setAll({centerX:w,x:0})):(e.setAll({y:w}),i.setAll({centerX:w,y:0}))),this.markDirtySize()}getNextValue(t){let e=t.get("index"),i=t.get("valueWorking",0);if(e<this.dataItems.length-1){let s=this.dataItems[e+1];if(i=s.get("valueWorking",0),s.isHidden()||s.get("value")==0&&this.get("ignoreZeroValues"))return this.getNextValue(s)}return i}isLast(t){let e=t.get("index");if(e==this.dataItems.length-1)return!0;for(let i=e+1;i<this.dataItems.length;i++)if(!this.dataItems[i].isHidden())return!1;return!0}decorateSlice(t){const e=this.get("orientation"),i=t.get("slice"),s=t.get("label"),a=t.get("link"),l=this.slicesContainer;let r=l.innerWidth(),c=l.innerHeight(),u=r;e=="horizontal"&&(u=c);const n=this.getNextValue(t),p=t.get("value",0),o=Math.abs(t.get("valueWorking",p)),h=this.get("bottomRatio",0),f=this.getPrivate("valueHigh",0);let g=1;p!=0?g=o/Math.abs(p):t.isHidden()&&(g=1e-6),this._nextCoord==1/0&&(this._nextCoord=0);let _=o/f*u,y=(o-(o-n)*h)/f*u;i.setAll({topWidth:_,bottomWidth:y,orientation:e}),a.setAll({topWidth:y,bottomWidth:(o-(o-n))/f*u,orientation:e});const v=this.get("startLocation",0),P=this.get("endLocation",1);if(e=="vertical"){let x=a.height()*g;c=c*(P-v)+x,i.set("y",this._nextCoord);let k=Math.min(1e5,Math.max(0,c/this._count*g/this._total-x));i.setAll({height:k,x:r/2});let A=this._nextCoord+k/2;s.set("y",A),this._nextCoord+=k+x,a.setAll({y:this._nextCoord-x,x:r/2})}else{let x=a.width()*g;r=r*(P-v)+x,i.set("x",this._nextCoord);let k=Math.min(1e5,Math.max(0,r/this._count*g/this._total-x));i.setAll({width:k,y:c/2});const A=this._nextCoord+k/2;s.set("x",A),this._nextCoord+=k+x,a.setAll({x:this._nextCoord-x,y:c/2})}}hideDataItem(t,e){const i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return I(this,void 0,void 0,function*(){return t.get("link").hide(e),i.hideDataItem.call(this,t,e)})}showDataItem(t,e){const i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return I(this,void 0,void 0,function*(){return t.get("link").show(e),i.showDataItem.call(this,t,e)})}_updateTick(t){if(this.get("alignLabels")){const e=t.get("tick"),i=t.get("label"),s=t.get("slice");if(e&&s&&i){const a=this.labelsContainer,l=this.slicesContainer;let r=e.get("location",.5);const c=a.width(),u=a.height(),n=a.get("paddingLeft",0),p=a.get("paddingRight",0),o=a.get("paddingTop",0),h=a.get("paddingBottom",0);let f={x:0,y:0},g={x:0,y:0},_={x:0,y:0};this._opposite&&(r=1-r),this.get("orientation")=="vertical"?(f=s.getPoint(r,.5),f.x+=s.x()+l.x(),f.y+=s.y()+l.y(),this._opposite?(g.x=c,g.y=i.y(),_.x=c-n,_.y=g.y):(g.x=l.x()+l.width(),g.y=i.y(),_.x=g.x+c-i.width()-p,_.y=g.y)):(f=s.getPoint(.5,r),f.x+=s.x()+l.x(),f.y+=s.y()+l.y(),this._opposite?(g.y=u,g.x=i.x(),_.y=u-o,_.x=g.x):(g.y=l.y()+l.height(),g.x=i.x(),_.y=g.y+u-i.height()-h,_.x=g.x)),e.set("points",[f,g,_])}}}disposeDataItem(t){super.disposeDataItem(t);let e=t.get("link");e&&(this.links.removeValue(e),e.dispose())}_positionBullet(t){const e=t.get("sprite");if(e){const s=e.dataItem.get("slice");if(s){const a=s.width(),l=s.height(),r=t.get("locationX",.5),c=t.get("locationY",.5);let u=0,n=0;this.get("orientation")=="horizontal"?n=l/2:u=a/2,e.setAll({x:s.x()+a*r-u,y:s.y()-n+l*c})}}}}Object.defineProperty(se,"className",{enumerable:!0,configurable:!0,writable:!0,value:"FunnelSeries"});Object.defineProperty(se,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:q.classNames.concat([se.className])});class re extends se{constructor(){super(...arguments),Object.defineProperty(this,"_tag",{enumerable:!0,configurable:!0,writable:!0,value:"pyramid"}),Object.defineProperty(this,"_nextSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_prepareChildren(){super._prepareChildren(),this._nextSize=void 0}decorateSlice(t){const e=this.get("orientation"),i=this.slicesContainer,s=t.get("slice"),a=t.get("label"),l=t.get("link"),r=this.get("valueIs","area"),c=this.getPrivate("valueAbsoluteSum",0);if(c==0)return;const u=this.get("startLocation",0),n=this.get("endLocation",1),p=this.get("topWidth",0),o=this.get("bottomWidth",F),h=Math.abs(t.get("valueWorking",0)),f=t.get("value",0);let g,_,y=i.innerHeight(),v=i.innerWidth(),P=l.width(),x=l.height();e=="horizontal"&&([v,y]=[y,v],[P,x]=[x,P]);const k=v/2;let A=1;f!=0?A=h/Math.abs(f):t.isHidden()&&(A=1e-6),x*=A,y=y*(n-u)-x*(this._count*this._total-1);let O=X(p,v);$(this._nextSize)||(this._nextSize=O);let j=X(o,v),R=this._nextSize,N=Math.atan2(y,O-j),D=Math.tan(Math.PI/2-N);if(D==0&&(D=1e-8),r=="area"){let H=(O+j)/2*y*h/c,J=Math.abs(R*R-2*H*D);g=(R-Math.sqrt(J))/D,g>0?_=(2*H-g*R)/g:_=R}else g=y*h/c,_=R-g*D;let T=this._nextCoord+g/2,d=k,m=this._nextCoord,M=k,V=m+g;e=="vertical"?(a.set("y",T),a.get("opacity")>0&&this._rLabels.push({label:a,y:T}),s.set("height",g)):(a.set("x",T),a.get("opacity")>0&&this._hLabels.push({label:a,y:T}),[d,m]=[m,d],[M,V]=[V,M],s.set("width",g)),s.setAll({orientation:e,bottomWidth:_,topWidth:R,x:d,y:m}),l.setAll({orientation:e,x:M,y:V,topWidth:_,bottomWidth:_}),this._nextSize=_,this._nextCoord+=g+x}}Object.defineProperty(re,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PyramidSeries"});Object.defineProperty(re,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:se.classNames.concat([re.className])});class fe extends re{constructor(){super(...arguments),Object.defineProperty(this,"_tag",{enumerable:!0,configurable:!0,writable:!0,value:"pictorial"}),Object.defineProperty(this,"seriesMask",{enumerable:!0,configurable:!0,writable:!0,value:te.new(this._root,{position:"absolute",x:w,y:w,centerX:w,centerY:w})}),Object.defineProperty(this,"seriesGraphics",{enumerable:!0,configurable:!0,writable:!0,value:this.slicesContainer.children.push(te.new(this._root,{themeTags:["pictorial","background"],position:"absolute",x:w,y:w,centerX:w,centerY:w}))})}_afterNew(){super._afterNew(),this.set("topWidth",F),this.set("bottomWidth",F),this.set("valueIs","height"),this.slicesContainer.set("mask",this.seriesMask)}_updateScale(){let t=this.slicesContainer,e=t.innerWidth(),i=t.innerHeight(),s=this.seriesMask,a=this.seriesGraphics,l=s.get("scale",1);const r=s.localBounds();let c=r.right-r.left,u=r.bottom-r.top;this.get("orientation")=="horizontal"?l=e/c:l=i/u,l!=1/0&&l!=NaN&&(s.set("scale",l),s.set("x",e/2),s.set("y",i/2),a.set("scale",l),a.set("x",e/2),a.set("y",i/2))}_prepareChildren(){if(super._prepareChildren(),this.isDirty("svgPath")){const t=this.get("svgPath");this.seriesMask.set("svgPath",t),this.seriesGraphics.set("svgPath",t)}this._updateScale()}}Object.defineProperty(fe,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PictorialStackedSeries"});Object.defineProperty(fe,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:re.classNames.concat([fe.className])});class be extends Y{_afterNew(){super._afterNew(),this.seriesContainer.setAll({isMeasured:!0,layout:this._root.horizontalLayout})}}Object.defineProperty(be,"className",{enumerable:!0,configurable:!0,writable:!0,value:"SlicedChart"});Object.defineProperty(be,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Y.classNames.concat([be.className])});const rt=Object.freeze(Object.defineProperty({__proto__:null,DefaultTheme:We,FunnelSeries:se,FunnelSlice:ie,PercentChart:Y,PercentSeries:q,PictorialStackedSeries:fe,PieChart:de,PieSeries:pe,PyramidSeries:re,SlicedChart:be},Symbol.toStringTag,{value:"Module"}));export{rt as a};
